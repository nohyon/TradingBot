# TurtleTrade 설명

## ExpectedValue
기댓값을 구하는 함수입니다.
E = 기댓값
PW = 이익을 거둘 확률
AW = 평균이익금액
PL = 손실을 기록할 확률
AL = 평균손실금액
E = (PW * AW) - (PL * AL)

## Unit
리스크 관리를 위해 자본금을 2%로 나눈것을 유닛이라고 합니다.
예로, 자본이 100000원 있다면, 이 경우 1유닛은 2000원 입니다.
한 자산에 유닛단위로 투자합니다. 
즉 100000원일때 계좌리스크 한도는 2000원이다.

## System1
시스템1은 최근 4주 가격돌파시 진입하고
반대방향으로 최근2주 최하가격이 뚫리면 청산하는 시스템입니다. 

## System2
시스템2는 최근 11주 가격돌파시 진입하고
반대방향으로 최근4주 최하가격이 뚫리면 청산하는 시스템입니다.

## RiskManage
이동평균(ATR), 다음중 가장 큰 값이 N(실변동폭)이 됩니다. 
만약 아랫값들이 음수가 나오면 절댓값으로 처리합니다.

1. 오늘의 고가와 저가 차이 = TR1
2. 어제의 종가와 오늘의 고가 차이 = TR2
3. 어제의 종가와 오늘의 저가 차이 = TR3

실변동폭(N)은 24시간동안 시장이 움직인 폭의 절댓값입니다. 
이동평균값을 쓰면, 최근 몇주간의 변동성을 알 수 있습니다. 

이동평균값(ATR) = D일동안 각각의 실변동폭(N) D개를 모두 구하고, D로 나눕니다. 
이를 날마다 계산하면서 이동평균값을 구합니다. 

이 프로그램에서는 ATR을 20일동안으로 계산합니다.

+로 N을 시장이 추세를따라 얼마나 멀리 움직였는지 보여주는 지표이기도 했다.
예로 옥수수의 N이 7센트이고, 시장이 5.25센트 올랐다면, 시장은 3/4N 올랐다고 표기

### 손절
위험한도 = 가격*단위 
예를들어, 옥수수(1센트 = 50달러)의 N이 7센트면, 위험한도는 7*50 = 350달러이다.
여기서, 2N으로 손절을 설정한 상태에서 돌파신호가 나온다면, 계약리스크 한도는 350*2인 700달러이다.
그리고 투자자금 10만달러의 계좌리스크 한도(2%)는 2000달러이다.
사거나 파는 계약 수는 이 금액을 계약리스크 한도로 나눠 구한다.
즉 2000/700 = 2.67, 소수점 이하 절사해서 2가 투자할 수 있는 계약 수 이다.
그래서 10만 달러를 갖고있을때, 돌파신호가 나오면 옥수수 두 계약을 거래할 수 있다.

+로, M을 System1,2와 같은 기본적 스톱에서도 활용하였다. 
그들은 손절시 2N 값을 적용했는데, 기본/하드 스톱을 일간 N값의 2배로 정했다.
예로 옥수수 돌파신호시 종가 250달러면, N값을 계산해서 손절가격을 설정했다.
N이 7달러면, 2N은 14달러, 이에 따라 스톱은 진입가에서 14달러 아래로 정해진다.
즉, 진입가가 250달러 이므로, 하드스톱은 250 - 14 = 236달러로 설정하고, 가격이 236달러가 되면 바로 청산한다.
==> 구글주식의 ATR이 20이면, 2ATR(2N) = 40 따라서 투자 후 40%손실이면, 바로 청산

### ATR과 추이 
위의 설명대로, ATR이 작을수록 투자할 수 있는 계약이 많아지고,
그 반대의 상황에는 줄어든다.
가장 좋은 추세는 초기의 돌파진입신호때 아주 낮은 변동성으로 시작한다. 
즉, N값이 작으면 저점이다.

